\name{Lform}
\Rdversion{1.1}
\alias{Lform}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{
Hypothesis matrix generated by expressions
%%  ~~function to do ... ~~
}
\description{
Creates an L matrix using expressions evaluated in 'data' for
each column of the L matrix
%%  ~~ A concise (1-5 lines) description of what the function does. ~~
}
\usage{
Lform(fit, form, data = model.frame(fit))
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{fit}{
  a fitted model with a 'getFix' method.
%%     ~~Describe \code{fit} here~~
}
  \item{form}{
  a list of expressions, one for each column of the hypothesis matrix.
%%     ~~Describe \code{form} here~~
}
  \item{data}{
  the data frame in which expressions are evaluated.
%%     ~~Describe \code{data} here~~
}
}
\details{
      Creates a linear hypothesis matrix, i.e. an L matrix,
      using formulas evaluated in 'data' for
      each column of the L matrix. This approach lends itself to creating hypotheses
      and estimates based on data such as partial derivatives with respect to variables
      evaluated at each data point.
      
      An example is the estimation of growth rates in longitudinal models.


%%  ~~ If necessary, more details than the description above ~~
}
\value{
%%  ~Describe the value returned
%%  If it is a LIST, use
%%  \item{comp1 }{Description of 'comp1'}
%%  \item{comp2 }{Description of 'comp2'}
%% ...
}
\references{
%% ~put references to the literature/web site here ~
}
\author{
%%  ~~who you are~~
}
\note{
%%  ~~further notes~~
}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\seealso{
%% ~~objects to See Also as \code{\link{help}}, ~~~
}
\examples{
\dontrun{
      library(car)
      mod <- lm( income ~ (education + I(education^2) )* type, Prestige)
      summary(mod)

      # estimate the marginal value of an extra year of education for a
      # range of years for each type
      
      years.type <- expand.grid( education = seq(6,18,2), type = levels(Prestige$type))
      Lf <- Lform( mod,
         list( 0, 1, 2*education, 0, 0, type =="prof", type =="wc",
            2*education*(type =="prof"), 2*education*(type =="wc")),
         years.type)
      Lf
      ww <- wald( mod, Lf)
      ww
      ytderiv <- as.data.frame( ww, se = 2)
      head( ytderiv )
      xyplot( coef ~ education, ytderiv, groups = type, type = 'l',
              auto.key = list(columns = 3, lines = TRUE, points = FALSE)
}
}
\keyword{ ~kwd1 }
\keyword{ ~kwd2 }% __ONLY ONE__ keyword per line